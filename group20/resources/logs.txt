Running on device: cuda:0
Critic network training round 1 (1000 games)
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [05:19<88:45:45, 319.87s/it]  0%|          | 2/1000 [08:36<68:35:04, 247.40s/it]  0%|          | 3/1000 [10:19<50:11:42, 181.25s/it]  0%|          | 4/1000 [11:13<36:16:44, 131.13s/it]  0%|          | 5/1000 [15:25<48:18:06, 174.76s/it]  1%|          | 6/1000 [17:48<45:16:47, 163.99s/it]  1%|          | 7/1000 [18:53<36:20:08, 131.73s/it]  1%|          | 8/1000 [20:40<34:04:19, 123.65s/it]  1%|          | 9/1000 [22:56<35:08:35, 127.66s/it]  1%|          | 10/1000 [24:00<29:43:20, 108.08s/it]  1%|          | 11/1000 [25:39<28:55:41, 105.30s/it]  1%|          | 12/1000 [31:27<49:08:41, 179.07s/it]  1%|▏         | 13/1000 [33:29<44:22:15, 161.84s/it]  1%|▏         | 14/1000 [37:00<48:20:15, 176.49s/it]  2%|▏         | 15/1000 [40:46<52:24:39, 191.55s/it]  2%|▏         | 16/1000 [43:42<51:03:10, 186.78s/it]  2%|▏         | 17/1000 [46:23<48:54:15, 179.10s/it]  2%|▏         | 18/1000 [47:51<41:23:14, 151.73s/it]  2%|▏         | 19/1000 [49:14<35:44:23, 131.16s/it]  2%|▏         | 20/1000 [51:55<38:06:24, 139.98s/it]  2%|▏         | 21/1000 [55:44<45:19:17, 166.66s/it]  2%|▏         | 22/1000 [58:40<46:02:23, 169.47s/it]  2%|▏         | 23/1000 [1:00:20<40:22:44, 148.79s/it]  2%|▏         | 24/1000 [1:02:09<37:02:10, 136.61s/it]  2%|▎         | 25/1000 [1:06:42<48:08:40, 177.76s/it]  3%|▎         | 26/1000 [1:09:26<46:57:37, 173.57s/it]  3%|▎         | 27/1000 [1:11:12<41:26:58, 153.36s/it]  3%|▎         | 28/1000 [1:14:40<45:46:05, 169.51s/it]  3%|▎         | 29/1000 [1:20:25<59:59:29, 222.42s/it]  3%|▎         | 30/1000 [1:20:54<44:15:21, 164.25s/it]  3%|▎         | 31/1000 [1:23:03<41:21:47, 153.67s/it]  3%|▎         | 32/1000 [1:26:44<46:46:14, 173.94s/it]  3%|▎         | 33/1000 [1:28:17<40:10:08, 149.54s/it]  3%|▎         | 34/1000 [1:29:44<35:07:46, 130.92s/it]  4%|▎         | 35/1000 [1:33:29<42:36:28, 158.95s/it]  4%|▎         | 36/1000 [1:33:48<31:20:23, 117.04s/it]  4%|▎         | 37/1000 [1:37:47<41:04:49, 153.57s/it]  4%|▍         | 38/1000 [1:37:54<29:19:09, 109.72s/it]  4%|▍         | 39/1000 [1:41:09<36:05:50, 135.22s/it]  4%|▍         | 40/1000 [1:46:35<51:18:28, 192.41s/it]  4%|▍         | 41/1000 [1:52:20<63:29:26, 238.34s/it]  4%|▍         | 42/1000 [1:52:54<47:05:53, 176.99s/it]  4%|▍         | 43/1000 [1:54:19<39:43:31, 149.44s/it]  4%|▍         | 44/1000 [1:55:14<32:08:36, 121.04s/it]  4%|▍         | 45/1000 [1:56:46<29:46:09, 112.22s/it]  5%|▍         | 46/1000 [1:57:30<24:23:13, 92.03s/it]   5%|▍         | 47/1000 [2:04:01<48:02:56, 181.51s/it]  5%|▍         | 48/1000 [2:04:27<35:41:28, 134.97s/it]  5%|▍         | 49/1000 [2:08:44<45:20:44, 171.66s/it]  5%|▌         | 50/1000 [2:11:09<43:11:28, 163.67s/it]  5%|▌         | 51/1000 [2:12:55<38:31:38, 146.15s/it]  5%|▌         | 52/1000 [2:16:20<43:10:20, 163.95s/it]  5%|▌         | 53/1000 [2:18:51<42:06:24, 160.07s/it]  5%|▌         | 54/1000 [2:20:26<36:55:01, 140.49s/it]  6%|▌         | 55/1000 [2:23:24<39:51:54, 151.87s/it]  6%|▌         | 56/1000 [2:25:06<35:52:18, 136.80s/it]  6%|▌         | 57/1000 [2:26:38<32:18:47, 123.36s/it]  6%|▌         | 58/1000 [2:28:26<31:01:48, 118.59s/it]  6%|▌         | 59/1000 [2:30:48<32:50:16, 125.63s/it]  6%|▌         | 60/1000 [2:33:57<37:49:25, 144.86s/it]  6%|▌         | 61/1000 [2:36:50<39:56:14, 153.11s/it]  6%|▌         | 62/1000 [2:40:54<47:01:22, 180.47s/it]  6%|▋         | 63/1000 [2:44:43<50:44:19, 194.94s/it]  6%|▋         | 64/1000 [2:45:06<37:17:08, 143.41s/it]  6%|▋         | 65/1000 [2:46:34<32:57:00, 126.87s/it]  7%|▋         | 66/1000 [2:47:32<27:31:28, 106.09s/it]  7%|▋         | 67/1000 [2:52:47<43:43:42, 168.73s/it]  7%|▋         | 68/1000 [2:55:26<42:58:31, 166.00s/it]  7%|▋         | 69/1000 [3:00:15<52:28:50, 202.93s/it]  7%|▋         | 70/1000 [3:04:54<58:18:03, 225.68s/it]  7%|▋         | 71/1000 [3:05:52<45:16:57, 175.48s/it]  7%|▋         | 72/1000 [3:15:02<74:07:44, 287.57s/it]  7%|▋         | 73/1000 [3:16:40<59:27:51, 230.93s/it]  7%|▋         | 74/1000 [3:18:40<50:49:44, 197.61s/it]  8%|▊         | 75/1000 [3:20:36<44:26:41, 172.97s/it]  8%|▊         | 76/1000 [3:26:00<56:03:40, 218.42s/it]  8%|▊         | 77/1000 [3:27:16<45:01:12, 175.59s/it]  8%|▊         | 78/1000 [3:31:21<50:17:58, 196.40s/it]  8%|▊         | 79/1000 [3:32:26<40:10:01, 157.01s/it]  8%|▊         | 80/1000 [3:38:00<53:41:17, 210.08s/it]  8%|▊         | 81/1000 [3:40:43<50:02:38, 196.04s/it]  8%|▊         | 82/1000 [3:42:36<43:37:23, 171.07s/it]  8%|▊         | 83/1000 [3:43:40<35:23:15, 138.93s/it]  8%|▊         | 84/1000 [3:45:15<31:58:53, 125.69s/it]  8%|▊         | 85/1000 [3:45:26<23:13:29, 91.38s/it]   9%|▊         | 86/1000 [3:46:58<23:16:41, 91.69s/it]  9%|▊         | 87/1000 [3:51:30<36:58:34, 145.80s/it]  9%|▉         | 88/1000 [3:55:01<41:52:27, 165.29s/it]  9%|▉         | 89/1000 [3:58:09<43:31:52, 172.02s/it]  9%|▉         | 90/1000 [4:01:37<46:15:19, 182.99s/it]  9%|▉         | 91/1000 [4:06:47<55:48:43, 221.04s/it]  9%|▉         | 92/1000 [4:11:07<58:41:26, 232.69s/it]  9%|▉         | 93/1000 [4:14:06<54:35:22, 216.67s/it]  9%|▉         | 94/1000 [4:15:50<45:57:17, 182.60s/it] 10%|▉         | 95/1000 [4:17:30<39:44:43, 158.10s/it] 10%|▉         | 96/1000 [4:17:36<28:12:10, 112.31s/it] 10%|▉         | 97/1000 [4:18:58<25:54:30, 103.29s/it] 10%|▉         | 98/1000 [4:24:58<45:11:20, 180.35s/it] 10%|▉         | 99/1000 [4:29:29<51:54:39, 207.41s/it] 10%|█         | 100/1000 [4:34:37<59:24:13, 237.61s/it]Episode: 100, Reward: -12.0, Wins: 44, Nr of iterations: 20335, Action percentages: Stop: 13.16% (2677), Up: 20.80% (4229), Down: 20.50% (4169), Left: 21.34% (4340), Right: 21.75% (4423), Bomb: 2.45% (498)
loss: 1.36960, action_loss: 0.88084, critic_loss: 0.48877
                                                         10%|█         | 100/1000 [4:34:37<59:24:13, 237.61s/it]                                                         10%|█         | 100/1000 [4:34:37<59:24:13, 237.61s/it] 10%|█         | 101/1000 [4:38:25<58:35:36, 234.63s/it] 10%|█         | 102/1000 [4:39:30<45:50:16, 183.76s/it] 10%|█         | 103/1000 [4:41:47<42:19:55, 169.89s/it] 10%|█         | 104/1000 [4:43:13<35:59:07, 144.58s/it] 10%|█         | 105/1000 [4:51:15<61:07:45, 245.88s/it] 11%|█         | 106/1000 [4:55:15<60:35:59, 244.03s/it] 11%|█         | 107/1000 [5:01:32<70:26:10, 283.95s/it] 11%|█         | 108/1000 [5:03:56<59:58:46, 242.07s/it] 11%|█         | 109/1000 [5:09:36<67:11:28, 271.48s/it] 11%|█         | 110/1000 [5:11:56<57:19:55, 231.90s/it] 11%|█         | 111/1000 [5:12:03<40:38:31, 164.58s/it] 11%|█         | 112/1000 [5:13:48<36:07:48, 146.47s/it] 11%|█▏        | 113/1000 [5:15:21<32:09:08, 130.49s/it] 11%|█▏        | 114/1000 [5:16:32<27:44:02, 112.69s/it] 12%|█▏        | 115/1000 [5:16:49<20:40:02, 84.07s/it]  12%|█▏        | 116/1000 [5:22:18<38:39:18, 157.42s/it] 12%|█▏        | 117/1000 [5:23:55<34:12:46, 139.49s/it] 12%|█▏        | 118/1000 [5:29:18<47:39:34, 194.53s/it] 12%|█▏        | 119/1000 [5:30:38<39:08:34, 159.95s/it] 12%|█▏        | 120/1000 [5:30:56<28:41:50, 117.40s/it] 12%|█▏        | 121/1000 [5:32:15<25:51:52, 105.93s/it] 12%|█▏        | 122/1000 [5:36:15<35:39:45, 146.23s/it] 12%|█▏        | 123/1000 [5:38:21<34:08:07, 140.12s/it] 12%|█▏        | 124/1000 [5:38:26<24:14:13, 99.60s/it]  12%|█▎        | 125/1000 [5:40:25<25:38:41, 105.51s/it] 13%|█▎        | 126/1000 [5:41:03<20:40:48, 85.18s/it]  13%|█▎        | 127/1000 [5:43:27<24:55:53, 102.81s/it] 13%|█▎        | 128/1000 [5:48:32<39:34:27, 163.38s/it] 13%|█▎        | 129/1000 [5:57:35<67:07:31, 277.44s/it] 13%|█▎        | 130/1000 [6:02:16<67:14:56, 278.27s/it] 13%|█▎        | 131/1000 [6:06:20<64:41:07, 267.97s/it] 13%|█▎        | 132/1000 [6:08:58<56:41:16, 235.11s/it] 13%|█▎        | 133/1000 [6:11:39<51:16:49, 212.93s/it] 13%|█▎        | 134/1000 [6:21:57<80:26:45, 334.42s/it] 14%|█▎        | 135/1000 [6:23:39<63:37:38, 264.81s/it] 14%|█▎        | 136/1000 [6:31:59<80:28:34, 335.32s/it] 14%|█▎        | 137/1000 [6:32:58<60:31:35, 252.49s/it] 14%|█▍        | 138/1000 [6:33:20<43:49:42, 183.04s/it] 14%|█▍        | 139/1000 [6:36:13<43:05:28, 180.17s/it] 14%|█▍        | 140/1000 [6:38:43<40:52:44, 171.12s/it] 14%|█▍        | 141/1000 [6:39:57<33:54:14, 142.09s/it] 14%|█▍        | 142/1000 [6:41:31<30:23:30, 127.52s/it] 14%|█▍        | 143/1000 [6:42:32<25:35:55, 107.53s/it] 14%|█▍        | 144/1000 [6:44:31<26:25:18, 111.12s/it] 14%|█▍        | 145/1000 [6:47:15<30:07:17, 126.83s/it] 15%|█▍        | 146/1000 [6:49:21<30:04:12, 126.76s/it] 15%|█▍        | 147/1000 [6:57:00<53:38:33, 226.39s/it] 15%|█▍        | 148/1000 [6:58:31<43:58:15, 185.79s/it] 15%|█▍        | 149/1000 [6:58:41<31:27:47, 133.10s/it] 15%|█▌        | 150/1000 [7:01:36<34:21:22, 145.51s/it] 15%|█▌        | 151/1000 [7:06:50<46:13:02, 195.97s/it] 15%|█▌        | 152/1000 [7:09:57<45:33:31, 193.41s/it] 15%|█▌        | 153/1000 [7:14:47<52:19:51, 222.42s/it] 15%|█▌        | 154/1000 [7:19:41<57:19:35, 243.94s/it] 16%|█▌        | 155/1000 [7:24:03<58:30:56, 249.30s/it] 16%|█▌        | 156/1000 [7:24:42<43:38:00, 186.11s/it] 16%|█▌        | 157/1000 [7:26:03<36:12:15, 154.61s/it] 16%|█▌        | 158/1000 [7:38:05<76:00:34, 324.98s/it] 16%|█▌        | 159/1000 [7:46:06<86:48:04, 371.56s/it] 16%|█▌        | 160/1000 [7:50:46<80:20:53, 344.35s/it] 16%|█▌        | 161/1000 [7:53:06<65:56:41, 282.96s/it] 16%|█▌        | 162/1000 [7:54:53<53:31:56, 229.97s/it] 16%|█▋        | 163/1000 [7:59:42<57:37:12, 247.83s/it] 16%|█▋        | 164/1000 [8:04:12<59:06:22, 254.52s/it] 16%|█▋        | 165/1000 [8:06:15<49:52:06, 215.00s/it] 17%|█▋        | 166/1000 [8:08:42<45:03:11, 194.47s/it] 17%|█▋        | 167/1000 [8:10:24<38:35:57, 166.82s/it] 17%|█▋        | 168/1000 [8:15:16<47:12:49, 204.29s/it] 17%|█▋        | 169/1000 [8:18:30<46:27:49, 201.29s/it] 17%|█▋        | 170/1000 [8:20:53<42:25:21, 184.00s/it] 17%|█▋        | 171/1000 [8:24:09<43:10:07, 187.46s/it] 17%|█▋        | 172/1000 [8:26:23<39:26:51, 171.51s/it] 17%|█▋        | 173/1000 [8:31:39<49:21:11, 214.84s/it] 17%|█▋        | 174/1000 [8:33:01<40:09:57, 175.06s/it] 18%|█▊        | 175/1000 [8:34:12<32:55:27, 143.67s/it] 18%|█▊        | 176/1000 [8:37:13<35:26:47, 154.86s/it] 18%|█▊        | 177/1000 [8:41:08<40:55:14, 179.00s/it] 18%|█▊        | 178/1000 [8:42:04<32:24:02, 141.90s/it] 18%|█▊        | 179/1000 [8:46:22<40:20:57, 176.93s/it] 18%|█▊        | 180/1000 [8:48:32<37:03:18, 162.68s/it] 18%|█▊        | 181/1000 [8:54:02<48:25:13, 212.84s/it] 18%|█▊        | 182/1000 [9:01:50<65:46:35, 289.48s/it] 18%|█▊        | 183/1000 [9:09:32<77:26:09, 341.21s/it] 18%|█▊        | 184/1000 [9:11:45<63:12:52, 278.89s/it] 18%|█▊        | 185/1000 [9:12:32<47:23:06, 209.31s/it] 19%|█▊        | 186/1000 [9:15:13<44:02:38, 194.79s/it] 19%|█▊        | 187/1000 [9:18:48<45:19:34, 200.71s/it] 19%|█▉        | 188/1000 [9:21:08<41:10:33, 182.55s/it] 19%|█▉        | 189/1000 [9:22:42<35:08:50, 156.02s/it] 19%|█▉        | 190/1000 [9:35:14<75:20:25, 334.85s/it] 19%|█▉        | 191/1000 [9:38:11<64:35:45, 287.45s/it] 19%|█▉        | 192/1000 [9:41:23<58:04:58, 258.79s/it] 19%|█▉        | 193/1000 [9:47:36<65:42:00, 293.09s/it] 19%|█▉        | 194/1000 [9:51:33<61:49:51, 276.17s/it] 20%|█▉        | 195/1000 [9:55:46<60:13:14, 269.31s/it] 20%|█▉        | 196/1000 [9:55:57<42:50:51, 191.85s/it] 20%|█▉        | 197/1000 [10:03:09<58:52:27, 263.94s/it] 20%|█▉        | 198/1000 [10:03:47<43:40:59, 196.08s/it] 20%|█▉        | 199/1000 [10:10:10<56:05:23, 252.09s/it] 20%|██        | 200/1000 [10:11:35<44:54:26, 202.08s/it]Episode: 200, Reward: -10.0, Wins: 45, Nr of iterations: 43574, Action percentages: Stop: 12.57% (2922), Up: 22.88% (5317), Down: 22.51% (5230), Left: 19.59% (4553), Right: 19.62% (4559), Bomb: 2.83% (658)
loss: 0.98262, action_loss: 0.64511, critic_loss: 0.33751
                                                          20%|██        | 200/1000 [10:11:35<44:54:26, 202.08s/it]                                                          20%|██        | 200/1000 [10:11:35<44:54:26, 202.08s/it] 20%|██        | 201/1000 [10:13:32<39:09:21, 176.42s/it] 20%|██        | 202/1000 [10:16:26<38:58:54, 175.86s/it] 20%|██        | 203/1000 [10:19:09<38:04:05, 171.95s/it] 20%|██        | 204/1000 [10:21:57<37:46:14, 170.82s/it] 20%|██        | 205/1000 [10:23:38<33:06:25, 149.92s/it] 21%|██        | 206/1000 [10:25:42<31:18:34, 141.96s/it] 21%|██        | 207/1000 [10:27:01<27:07:45, 123.16s/it] 21%|██        | 208/1000 [10:29:53<30:17:28, 137.69s/it] 21%|██        | 209/1000 [10:35:00<41:27:40, 188.70s/it] 21%|██        | 210/1000 [10:39:41<47:26:44, 216.21s/it] 21%|██        | 211/1000 [10:41:11<39:07:15, 178.50s/it] 21%|██        | 211/1000 [10:41:37<39:59:15, 182.45s/it]
Traceback (most recent call last):
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/train_agent.py", line 419, in <module>
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/train_agent.py", line 272, in train
    new_game = False
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/trainer.py", line 366, in select_action_mcts
    self.tree.do_rollout()
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/mcts.py", line 74, in do_rollout
    reward = self._simulate(leaf, leaf_value)
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/mcts.py", line 113, in _simulate
    actions, action_probs, state_v = self.get_nn_outputs(node)
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/mcts.py", line 155, in get_nn_outputs
    action_probs, state_v = self._policy(node.obs, self.agent_id, device=self.device)
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/trainer.py", line 400, in policy_value_fn
    bombs, can_kick, flame_life)
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/trainer.py", line 208, in get_safe_actions
    board_, q = util.get_next_position_with_board_copy(obs, a, position, trainee_id)
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/util.py", line 125, in get_next_position_with_board_copy
    actions[trainee_id] = action
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/util.py", line 100, in make_step
    bomber = characters.Bomber()
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/game_state.py", line 25, in game_state_from_obs
    convert_agents(obs["board"], obs["ammo"], agent_id),
  File "/home/tobias/OneDrive/JKU/3/ai/challenge/pommerman_students/student_agents/group20/group20/game_state.py", line 78, in convert_items
    def convert_items(board):
  File "/home/tobias/miniconda3/envs/unicorn_challenge/lib/python3.7/types.py", line 169, in __get__
    elif self.fget is None:
KeyboardInterrupt
